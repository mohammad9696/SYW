package Services;


import Constants.ConstantsEnum;
import Constants.HttpRequestAuthTypeEnum;
import DTO.GQLMutationTranslationsVariablesDTO;
import DTO.GQLQueryTranslatableResourceResponseDTO;
import DTO.OpenAIRequestDTO;
import DTO.OpenAIResponseDTO;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class OpenAIService {

    public static Map<String, List<GQLMutationTranslationsVariablesDTO.Translation>> memory = new HashMap<>();
    public static OpenAIResponseDTO getTranslate(List<GQLQueryTranslatableResourceResponseDTO.TranslatableContent> translatableContents) throws JsonProcessingException {

        String schema = "{\"resourceId1\":\"gid://shopify/Metafield/42895600320858\",\"translations1\":[{\"locale\":\"fr\",\"translatableContentDigest\":\"4c8f146e56cb2d367f703b8eeb16d9f834d854be7d31864efc2021378944bd39\",\"key\":\"value\",\"value\":\"Disponible pour âœ… LIVRAISON IMMÃ‰DIATE. n\uD83D\uDE9A ReÃ§oit \uD83C\uDDEB\uD83C\uDDF7 mardi, 5 novembre\"},{\"locale\":\"en\",\"translatableContentDigest\":\"4c8f146e56cb2d367f703b8eeb16d9f834d854be7d31864efc2021378944bd39\",\"key\":\"value\",\"value\":\"Available for âœ… IMMEDIATE DELIVERY. n\uD83D\uDE9A Receives \uD83C\uDDEC\uD83C\uDDE7 Tuesday, November 5th\"},{\"locale\":\"es\",\"translatableContentDigest\":\"4c8f146e56cb2d367f703b8eeb16d9f834d854be7d31864efc2021378944bd39\",\"key\":\"value\",\"value\":\"Disponible para âœ… ENTREGA INMEDIATA. n\uD83D\uDE9A Recibe \uD83C\uDDEA\uD83C\uDDF8 martes, 5 de noviembre\"},{\"locale\":\"it\",\"translatableContentDigest\":\"4c8f146e56cb2d367f703b8eeb16d9f834d854be7d31864efc2021378944bd39\",\"key\":\"value\",\"value\":\"Disponibile per âœ… CONSEGNA IMMEDIATA. n\uD83D\uDE9A Riceve \uD83C\uDDEE\uD83C\uDDF9 martedÃ¬, 5 novembre\"},{\"locale\":\"de\",\"translatableContentDigest\":\"4c8f146e56cb2d367f703b8eeb16d9f834d854be7d31864efc2021378944bd39\",\"key\":\"value\",\"value\":\"VerfÃ¼gbar fÃ¼r âœ… SOFORTIGE LIEFERUNG. n\uD83D\uDE9A ErhÃ¤lt \uD83C\uDDE9\uD83C\uDDEA Dienstag, 5. November\"}],\"resourceId2\":\"gid://shopify/Metafield/42895600976218\",\"translations2\":[{\"locale\":\"fr\",\"translatableContentDigest\":\"9501a90325d5c262f9fa313cab370e0a7f998a86d18511da4baf292e92ec98e8\",\"key\":\"value\",\"value\":\"mardi, 5 novembre et jeudi, 7 novembre\"},{\"locale\":\"en\",\"translatableContentDigest\":\"9501a90325d5c262f9fa313cab370e0a7f998a86d18511da4baf292e92ec98e8\",\"key\":\"value\",\"value\":\"Tuesday, November 5th and Thursday, November 7th\"},{\"locale\":\"es\",\"translatableContentDigest\":\"9501a90325d5c262f9fa313cab370e0a7f998a86d18511da4baf292e92ec98e8\",\"key\":\"value\",\"value\":\"martes, 5 de noviembre y jueves, 7 de noviembre\"},{\"locale\":\"it\",\"translatableContentDigest\":\"9501a90325d5c262f9fa313cab370e0a7f998a86d18511da4baf292e92ec98e8\",\"key\":\"value\",\"value\":\"martedÃ¬, 5 novembre e giovedÃ¬, 7 novembre\"},{\"locale\":\"de\",\"translatableContentDigest\":\"9501a90325d5c262f9fa313cab370e0a7f998a86d18511da4baf292e92ec98e8\",\"key\":\"value\",\"value\":\"Dienstag, 5. November und Donnerstag, 7. November\"}],\"resourceId3\":\"gid://shopify/Metafield/42895601238362\",\"translations3\":[{\"locale\":\"fr\",\"translatableContentDigest\":\"77a95ff813b2c196a92b0ae4bd3364799f72278f01ca8081972e0f432c04680e\",\"key\":\"value\",\"value\":\"jeudi, 7 novembre et vendredi, 8 novembre\"},{\"locale\":\"en\",\"translatableContentDigest\":\"77a95ff813b2c196a92b0ae4bd3364799f72278f01ca8081972e0f432c04680e\",\"key\":\"value\",\"value\":\"Thursday, November 7th and Friday, November 8th\"},{\"locale\":\"es\",\"translatableContentDigest\":\"77a95ff813b2c196a92b0ae4bd3364799f72278f01ca8081972e0f432c04680e\",\"key\":\"value\",\"value\":\"jueves, 7 de noviembre y viernes, 8 de noviembre\"},{\"locale\":\"it\",\"translatableContentDigest\":\"77a95ff813b2c196a92b0ae4bd3364799f72278f01ca8081972e0f432c04680e\",\"key\":\"value\",\"value\":\"giovedÃ¬, 7 novembre e venerdÃ¬, 8 novembre\"},{\"locale\":\"de\",\"translatableContentDigest\":\"77a95ff813b2c196a92b0ae4bd3364799f72278f01ca8081972e0f432c04680e\",\"key\":\"value\",\"value\":\"Donnerstag, 7. November und Freitag, 8. November\"}]}";
        ObjectMapper mapper = new ObjectMapper();
        String jsonRequest = mapper.writeValueAsString(translatableContents);
        OpenAIRequestDTO dto = new OpenAIRequestDTO("gpt-4o-mini", null, 1500, 0.5);
        List<OpenAIRequestDTO.Message> messages = new ArrayList<>();
        /*
        messages.add(new OpenAIRequestDTO.Message("system","You are a translation assistant skilled in providing JSON-formatted translations in multiple languages that ONLY outputs the json object in one line ensuring there are no extra `{` or `}` characters that may be resulted from poor escaping"));
        messages.add(new OpenAIRequestDTO.Message("system","You always check and fix json formatting and specially second last '}' of the response, iy often gets added wrongfully and messes entire structure, by removing it the structure gets fixed"));
        messages.add(new OpenAIRequestDTO.Message("user","Keep emojis as they are. Translate flags only to France, Britain, Spain, Italy, Germany"));
        messages.add(new OpenAIRequestDTO.Message("user","translate the following texts/ resources into all 5 languages [fr,en,es,it,de], and return the result in JSON format"));
        messages.add(new OpenAIRequestDTO.Message("user","This schema is a valid response example. Follow this structure and only change values and not keys. Schema: "+schema));
        messages.add(new OpenAIRequestDTO.Message("user","It is very important for schema to always have the keys: resourceId1, translations1, resourceId2, translations2, resourceId3, translations3"));
        messages.add(new OpenAIRequestDTO.Message("user","It is very important for schema of object translations to always have keys: locale, translatableContentDigest, key, value"));
        messages.add(new OpenAIRequestDTO.Message("user","Request: "+ jsonRequest));
*/
        messages.add(new OpenAIRequestDTO.Message("system", "You are a translation assistant. Always return JSON translations in a single line, formatted strictly with no extra `{` or `}` characters."));
        messages.add(new OpenAIRequestDTO.Message("system", "Check JSON syntax carefully, especially for any trailing or misplaced braces. Ensure no errors by verifying structure manually."));
        messages.add(new OpenAIRequestDTO.Message("user", "Translate the following texts into French, English, Spanish, Italian, and German. Keep emojis as they are, and translate flags only to ðŸ‡«ðŸ‡·, ðŸ‡¬ðŸ‡§, ðŸ‡ªðŸ‡¸, ðŸ‡®ðŸ‡¹, and ðŸ‡©ðŸ‡ª."));
        messages.add(new OpenAIRequestDTO.Message("user", "Use this JSON schema format, changing only values, not keys: " + schema));
        messages.add(new OpenAIRequestDTO.Message("user", "Ensure the JSON always includes keys: `resourceId1`, `translations1`, `resourceId2`, `translations2`, `resourceId3`, `translations3`."));
        messages.add(new OpenAIRequestDTO.Message("user", "Within each `translations` object, always include `locale`, `translatableContentDigest`, `key`, and `value`."));
        messages.add(new OpenAIRequestDTO.Message("user", "Here is the request data: " + jsonRequest));
        dto.setMessages(messages);

        OpenAIResponseDTO result = HttpRequestExecutor.sendRequest(OpenAIResponseDTO.class, dto, null, ConstantsEnum.OPENAI_REQUEST_URL.getConstantValue().toString(), HttpRequestAuthTypeEnum.BEARER_TOKEN,
                ConstantsEnum.OPENAI_API_KEY.getConstantValue().toString());


        return result;
    }

    public static OpenAIResponseDTO getTranslations (List<GQLQueryTranslatableResourceResponseDTO.TranslatableContent> translatableContents) throws JsonProcessingException {
        //String schema = "{\"translations\":[{\"translatableContent\":\"DisponÃ­vel por âœ… ENCOMENDA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"fr\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"Disponible pour âœ… COMMANDE. \\n\uD83D\uDE9A ReÃ§oit \uD83C\uDDEB\uD83C\uDDF7 vendredi, 22 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatableContent\":\"DisponÃ­vel por âœ… ENCOMENDA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"en\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"Available for âœ… ORDER. \\n\uD83D\uDE9A Receives \uD83C\uDDEC\uD83C\uDDE7 Friday, November 22nd\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatableContent\":\"DisponÃ­vel por âœ… ENCOMENDA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"es\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"Disponible para âœ… PEDIDO. \\n\uD83D\uDE9A Recibe \uD83C\uDDEA\uD83C\uDDF8 viernes, 22 de noviembre\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatableContent\":\"DisponÃ­vel por âœ… ENCOMENDA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"it\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"Disponibile per âœ… ORDINE. \\n\uD83D\uDE9A Riceve \uD83C\uDDEE\uD83C\uDDF9 venerdÃ¬, 22 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatableContent\":\"DisponÃ­vel por âœ… ENCOMENDA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"de\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"VerfÃ¼gbar fÃ¼r âœ… BESTELLUNG. \\n\uD83D\uDE9A ErhÃ¤lt \uD83C\uDDE9\uD83C\uDDEA Freitag, 22. November\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatableContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"fr\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"ReÃ§oit entre mercredi, 20 novembre et vendredi, 22 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatableContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"en\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"Receives between Wednesday, November 20th and Friday, November 22nd\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatableContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"es\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"Recibe entre miÃ©rcoles, 20 de noviembre y viernes, 22 de noviembre\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatableContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"it\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"Riceve tra mercoledÃ¬, 20 novembre e venerdÃ¬, 22 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatableContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"de\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"ErhÃ¤lt zwischen Mittwoch, 20. November und Freitag, 22. November\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatableContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"fr\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"Disponible pour âœ… LIVRAISON IMMEDIATE. \\n\uD83D\uDE9A ReÃ§oit \uD83C\uDDEB\uD83C\uDDF7 mercredi, 20 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"},{\"translatableContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"en\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"Available for âœ… IMMEDIATE DELIVERY. \\n\uD83D\uDE9A Receives \uD83C\uDDEC\uD83C\uDDE7 Wednesday, November 20th\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"},{\"translatableContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"es\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"Disponible para âœ… ENTREGA INMEDIATA. \\n\uD83D\uDE9A Recibe \uD83C\uDDEA\uD83C\uDDF8 miÃ©rcoles, 20 de noviembre\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"},{\"translatableContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"it\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"Disponibile per âœ… CONSEGNA IMMEDIATA. \\n\uD83D\uDE9A Riceve \uD83C\uDDEE\uD83C\uDDF9 mercoledÃ¬, 20 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"},{\"translatableContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. \\n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"de\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"VerfÃ¼gbar fÃ¼r âœ… SOFORTIGE LIEFERUNG. \\n\uD83D\uDE9A ErhÃ¤lt \uD83C\uDDE9\uD83C\uDDEA Mittwoch, 20. November\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"}]}";


        //no object  translations
        String schema = "[{\"translatedContent\":\"DisponÃ­vel por âœ… ENCOMENDA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"fr\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"Disponible pour âœ… COMMANDE. n\uD83D\uDE9A ReÃ§oit \uD83C\uDDEB\uD83C\uDDF7 vendredi, 22 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatedContent\":\"DisponÃ­vel por âœ… ENCOMENDA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"en\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"Available for âœ… ORDER. n\uD83D\uDE9A Receives \uD83C\uDDEC\uD83C\uDDE7 Friday, November 22nd\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatedContent\":\"DisponÃ­vel por âœ… ENCOMENDA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"es\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"Disponible para âœ… PEDIDO. n\uD83D\uDE9A Recibe \uD83C\uDDEA\uD83C\uDDF8 viernes, 22 de noviembre\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatedContent\":\"DisponÃ­vel por âœ… ENCOMENDA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"it\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"Disponibile per âœ… ORDINE. n\uD83D\uDE9A Riceve \uD83C\uDDEE\uD83C\uDDF9 venerdÃ¬, 22 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatedContent\":\"DisponÃ­vel por âœ… ENCOMENDA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 sexta-feira, 22 de novembro\",\"locale\":\"de\",\"translatableContentDigest\":\"430340fc8318651050c4685349adec10a20ef94f7dc978e6035cd23fc48a9e0f\",\"key\":\"value\",\"value\":\"VerfÃ¼gbar fÃ¼r âœ… BESTELLUNG. n\uD83D\uDE9A ErhÃ¤lt \uD83C\uDDE9\uD83C\uDDEA Freitag, 22. November\",\"resourceId\":\"gid://shopify/Metafield/23717041078529\"},{\"translatedContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"fr\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"ReÃ§oit entre mercredi, 20 novembre et vendredi, 22 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatedContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"en\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"Receives between Wednesday, November 20th and Friday, November 22nd\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatedContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"es\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"Recibe entre miÃ©rcoles, 20 de noviembre y viernes, 22 de noviembre\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatedContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"it\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"Riceve tra mercoledÃ¬, 20 novembre e venerdÃ¬, 22 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatedContent\":\"Recebe entre quarta-feira, 20 de novembro e sexta-feira, 22 de novembro\",\"locale\":\"de\",\"translatableContentDigest\":\"fc4d1d433c662c3951056750c57332b792910effa7d2f6884e43fbef743c61b2\",\"key\":\"value\",\"value\":\"ErhÃ¤lt zwischen Mittwoch, 20. November und Freitag, 22. November\",\"resourceId\":\"gid://shopify/Metafield/23717041209601\"},{\"translatedContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"fr\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"Disponible pour âœ… LIVRAISON IMMEDIATE. n\uD83D\uDE9A ReÃ§oit \uD83C\uDDEB\uD83C\uDDF7 mercredi, 20 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"},{\"translatedContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"en\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"Available for âœ… IMMEDIATE DELIVERY. n\uD83D\uDE9A Receives \uD83C\uDDEC\uD83C\uDDE7 Wednesday, November 20th\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"},{\"translatedContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"es\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"Disponible para âœ… ENTREGA INMEDIATA. n\uD83D\uDE9A Recibe \uD83C\uDDEA\uD83C\uDDF8 miÃ©rcoles, 20 de noviembre\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"},{\"translatedContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"it\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"Disponibile per âœ… CONSEGNA IMMEDIATA. n\uD83D\uDE9A Riceve \uD83C\uDDEE\uD83C\uDDF9 mercoledÃ¬, 20 novembre\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"},{\"translatedContent\":\"DisponÃ­vel para âœ… ENTREGA IMEDIATA. n\uD83D\uDE9A Recebe \uD83C\uDDF5\uD83C\uDDF9 Quarta-feira, 20 de novembro\",\"locale\":\"de\",\"translatableContentDigest\":\"55aa5a800d3cbfac8a2192a6ebb306c413ce7eec99cd264f54d7d20c8e871a82\",\"key\":\"value\",\"value\":\"VerfÃ¼gbar fÃ¼r âœ… SOFORTIGE LIEFERUNG. n\uD83D\uDE9A ErhÃ¤lt \uD83C\uDDE9\uD83C\uDDEA Mittwoch, 20. November\",\"resourceId\":\"gid://shopify/Metafield/23717057560833\"}]";

        ObjectMapper mapper = new ObjectMapper();
        String jsonRequest = mapper.writeValueAsString(translatableContents);
        OpenAIRequestDTO dto = new OpenAIRequestDTO("gpt-4o-mini", null, 16384, 0.5);
        List<OpenAIRequestDTO.Message> messages = new ArrayList<>();


        messages.add(new OpenAIRequestDTO.Message("system", "You are a translation assistant. Always return JSON translations in a single line, formatted strictly."));
        //messages.add(new OpenAIRequestDTO.Message("system", "Check JSON syntax carefully, especially for any trailing or misplaced braces. Ensure no errors by verifying structure manually."));
        messages.add(new OpenAIRequestDTO.Message("user", "Translate the following texts into French, English, Spanish, Italian, and German. Keep emojis as they are, and translate flags only to ðŸ‡«ðŸ‡·, ðŸ‡¬ðŸ‡§, ðŸ‡ªðŸ‡¸, ðŸ‡®ðŸ‡¹, and ðŸ‡©ðŸ‡ª."));
        messages.add(new OpenAIRequestDTO.Message("user", "Use this JSON schema format, changing only values, not keys: " + schema));
        messages.add(new OpenAIRequestDTO.Message("user", "Ensure the JSON always includes a list of translations, 5 translations per request (one for each language always, even if you repeat yourself)"));
        messages.add(new OpenAIRequestDTO.Message("user", "Only one array list of translations exists and each object in it, always include `resourceId`, `locale`, `translatableContentDigest`, `key`, and `value`, `translatableContent`."));
        messages.add(new OpenAIRequestDTO.Message("user", "resourceId will be as given. locale will be two letters of the language, tranlatableContentDigest will be the digest given, key will be always the same written value, value will be the translation, translatedContent will be the original text that was translated"));
        messages.add(new OpenAIRequestDTO.Message("user", "Here is the request data: " + jsonRequest));
        messages.add(new OpenAIRequestDTO.Message("user", "Total of " + translatableContents.size() + " texts to translate. I must receive an array "+translatableContents.size() +" * 5 = " + translatableContents.size()*5 + " translations long." ));
        dto.setMessages(messages);

        OpenAIResponseDTO result = HttpRequestExecutor.sendRequest(OpenAIResponseDTO.class, dto, null, ConstantsEnum.OPENAI_REQUEST_URL.getConstantValue().toString(), HttpRequestAuthTypeEnum.BEARER_TOKEN,
                ConstantsEnum.OPENAI_API_KEY.getConstantValue().toString());

        return result;
    }
    public static void main(String[] args) {




    }
}
